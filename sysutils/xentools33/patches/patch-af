$NetBSD: patch-af,v 1.3 2009/08/07 12:49:21 cegger Exp $

--- misc/Makefile.orig	2009-08-06 14:56:36.000000000 +0200
+++ misc/Makefile
@@ -14,17 +14,21 @@ TARGETS-y := xenperf
 TARGETS-$(CONFIG_X86) += xen-detect xenpm
 TARGETS := $(TARGETS-y)
 
-SUBDIRS-$(CONFIG_LOMOUNT) += lomount
+#SUBDIRS-$(CONFIG_LOMOUNT) += lomount
 SUBDIRS-$(CONFIG_MINITERM) += miniterm
 SUBDIRS := $(SUBDIRS-y)
 
-INSTALL_BIN-y := xencons
+INSTALL_BIN-y :=
+INSTALL_BIN_SCRIPT-y := xencons
 INSTALL_BIN-$(CONFIG_X86) += xen-detect
 INSTALL_BIN := $(INSTALL_BIN-y)
+INSTALL_BIN_SCRIPT := $(INSTALL_BIN_SCRIPT-y)
 
-INSTALL_SBIN-y := xm xen-bugtool xen-python-path xend xenperf xsview
+INSTALL_SBIN-y := xenperf
+INSTALL_SBIN_SCRIPT-y := xm xen-bugtool xen-python-path xend xsview
 INSTALL_SBIN-$(CONFIG_X86) += xenpm
 INSTALL_SBIN := $(INSTALL_SBIN-y)
+INSTALL_SBIN_SCRIPT := $(INSTALL_SBIN_SCRIPT-y)
 
 DEFAULT_PYTHON_PATH := $(shell $(XEN_ROOT)/tools/python/get-path)
 PYTHON_PATH ?= $(DEFAULT_PYTHON_PATH)
@@ -40,10 +44,12 @@ build: $(TARGETS)
 
 .PHONY: install
 install: build
-	$(INSTALL_DIR) $(DESTDIR)$(BINDIR)
-	$(INSTALL_DIR) $(DESTDIR)$(SBINDIR)
-	$(INSTALL_PYTHON_PROG) $(INSTALL_BIN) $(DESTDIR)$(BINDIR)
-	$(INSTALL_PYTHON_PROG) $(INSTALL_SBIN) $(DESTDIR)$(SBINDIR)
+	$(BSD_INSTALL_PROGRAM_DIR) $(DESTDIR)$(BINDIR)
+	$(BSD_INSTALL_PROGRAM_DIR) $(DESTDIR)$(SBINDIR)
+	$(BSD_INSTALL_PROGRAM) $(INSTALL_BIN) $(DESTDIR)$(BINDIR)
+	$(BSD_INSTALL_SCRIPT) $(INSTALL_BIN_SCRIPT) $(DESTDIR)$(BINDIR)
+	$(BSD_INSTALL_PROGRAM) $(INSTALL_SBIN) $(DESTDIR)$(SBINDIR)
+	$(BSD_INSTALL_SCRIPT) $(INSTALL_SBIN_SCRIPT) $(DESTDIR)$(SBINDIR)
 	set -e; for d in $(SUBDIRS); do $(MAKE) -C $$d install-recurse; done
 
 .PHONY: clean
